.lesson
  .row
    .col-md-7.floatright
      .box
        %h2.title
          -if @lesson.skill
            = @lesson.skill.title
        .container
          %a{href: user_path(@lesson.teacher), class:"circle-overlay"}
            = image_tag @lesson.teacher.picture
          %h4.instructor
            = link_to @lesson.teacher.name, user_path(@lesson.teacher)
        %hr.div-line
        %h4 Messages
        .messages
          =render "/conversations/reply", conversation: @lesson.conversation
          -@lesson.conversation.messages.each do |message|
            =render "/conversations/message", message: message

    .col-md-5
      .box
        .skill-image-full
          -if @lesson.skill
            = image_tag @lesson.skill.picture
      .box
        %h3 Status
        %br
        - if current_user == @lesson.teacher
          - if !@lesson.approved
            = link_to "Accept", approve_lesson_path(id: @lesson.id), class: "button btn btn-custom"
            = link_to "Ignore", ignore_lesson_path(id: @lesson.id), class: "button btn btn-custom"
          - elsif !@lesson.completed
            .accepted
              Accepted!

        - else
          -if !@lesson.approved && !@lesson.ignored
            .pending-approval
              Pending Response
          - elsif !@lesson.approved && @lesson.ignored
            .denied
              Not Accepted
          - elsif @lesson.approved
            .accepted
              Accepted!
            .review
              = link_to "Review Teacher", skill_path(id: @lesson.skill.id), class: "button btn btn-custom"
      -if @lesson.approved
        .box
          %h3 Review for #{@other_user.first_name}
          %br
          %Review
          - if @review.user == current_user
            = render partial: "skills/review_short", collection: [@review]
          - else
            = render partial: "skills/add_review", locals: { lesson: @lesson, review: @review, user: current_user, target_user: @other_user}